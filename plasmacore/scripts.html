<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Content generated by Mediawiki and mw2html -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15.1" />
		<meta name="keywords" content="Scripts" />
		<link rel="shortcut icon" href="http://plasmaworks.com/sites/default/files/sky_favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Plasmaworks (en)" />
		<link rel="alternate" type="application/rss+xml" title="Plasmaworks RSS Feed" href="" />
		<link rel="alternate" type="application/atom+xml" title="Plasmaworks Atom Feed" href="" />
		<title>Scripts - Plasmaworks</title>
		<link rel="stylesheet" href="shared.css" type="text/css" media="screen" />
		<link rel="stylesheet" href="commonprint.css" type="text/css" media="print" />
		<link rel="stylesheet" href="main.css" type="text/css" media="screen" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="ie50fixes.css" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="ie55fixes.css" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="ie60fixes.css" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="ie70fixes.css" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="" type="text/css" />
		<link rel="stylesheet" href="" type="text/css" media="print" />
		<link rel="stylesheet" href="" type="text/css" />
		<link rel="stylesheet" href="" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="iefixes.js_207"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/wiki/skins";
		var wgArticlePath = "/wiki/index.php/$1";
		var wgScriptPath = "/wiki";
		var wgScript = "/wiki/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://www.plasmaworks.com";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Scripts";
		var wgTitle = "Scripts";
		var wgAction = "view";
		var wgArticleId = "137";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 850;
		var wgVersion = "1.15.1";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="wikibits.js_207"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="ajax.js_207"></script>
		<script type="text/javascript" src=""><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Scripts skin-monobook">
	<div id="globalWrapperHacked">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Scripts</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Plasmaworks</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<a name="Overview" id="Overview"></a><h2> <span class="mw-headline"> Overview </span></h2>
<p>A Plasmacore <i>Script</i> is an object-oriented list of commands that are sequentially executed.  A Script is used to enqueue a series of actions to be executed over time and is better suited to modeling pre-planned actions than a state machine.
</p><p>To use scripts:
</p>
<ul><li> [include "script.slag"]
</li><li> Add a Script property to any and all classes that could make use of it.
</li><li> Extend "Cmd", override <i>on_activate()</i> to perform setup, and override <i>execute().Cmd</i> to perform an action whenever Script::update() is called; return "this" to execute the same command on the next update() or return "next" to continue executing the next command.
</li><li> Add extended Cmd objects to a script with Script::add(Cmd).
</li><li> Add "CmdFn&lt;&lt;arbitrary code&gt;&gt;()" objects that execute a small piece of arbitrary code without having to create an entire class.
</li><li> Add predefined CmdWait(seconds) objects to pause script execution.
</li><li> Call Script::update().Logical to update a script.  It will return "false" if there are no remaining commands.
</li><li> Use a CmdGroup object to execute multiple commands simultaneously.  Each command can be its own Script if desired.
</li><li> Instead of returning "this" or "next" from Command::execute(), you can return a new Cmd object or chain of objects to be the next command.
</li></ul>
<a name="Examples" id="Examples"></a><h2> <span class="mw-headline"> Examples </span></h2>
<pre> # Test app that cycles the background color through red, green, and blue, changing every second.
 # A debug message is printed out when the script is finished.
 [include "script.slag"]
  
 class Test&nbsp;: Screen
   PROPERTIES
     script()&nbsp;: Script
  
   METHODS
     method init
       script.add( CmdWait(1) )
       script.add( CmdBGColor(Color.red) )
       script.add( CmdWait(1) )
       script.add( CmdBGColor(Color.green) )
       script.add( CmdWait(1) )
       script.add( CmdBGColor(Color.blue) )
       script.add( CmdFn&lt;&lt;println("Script finished")&gt;&gt;() )
  
     method update
       script.update
 endClass
  
 class CmdBGColor( Color color )&nbsp;: Cmd
   METHODS
     method on_activate
       Display.background_color = color
 endClass
</pre>
<pre> # Test app that moves a box to four corners of the screen
 # over and over, changing the color of the box after every 
 # cycle.
 [include "script.slag"]
  
 singleton class Test&nbsp;: Screen
   PROPERTIES
     script()&nbsp;: Script
     square(0,0,64,64)&nbsp;: Box
     color=Color.red&nbsp;: Color
  
   METHODS
     method update
       if (not script.update)
         local var x2 = Display.size.x - 64
         local var y2 = Display.size.y - 64
         script.add( CmdMoveSquare( x2,  0, 1.0 ) )
         script.add( CmdMoveSquare( x2, y2, 1.0 ) )
         script.add( CmdMoveSquare(  0, y2, 1.0 ) )
         script.add( CmdMoveSquare(  0,  0, 1.0 ) )
         script.add( CmdFn&lt;&lt;Test.color=random_Color&gt;&gt;() )
       endIf
 
     method draw
       square.fill( color )
 endClass
  
 class CmdMoveSquare( Real64 dest_x, Real64 dest_y, Real64 interval )&nbsp;: Cmd
   PROPERTIES
     ticks&nbsp;: Int32
     delta&nbsp;: Vector2

   METHODS
     method on_activate
       ticks = interval * 60
       delta = (Vector2(dest_x,dest_y) - Test.square.position) / ticks

     method execute.Cmd
       Test.square += delta
       --ticks
       if (ticks?) return this
       else        return next
   endClass
</pre>
<pre> # This script-based example types out a message, blinks
 # it three times, and repeats.
 [include "script.slag"]
  
 singleton class Test&nbsp;: Screen
   PROPERTIES
     message &nbsp;: Message
     script()&nbsp;: Script
  
   METHODS
     method init
       message = Message( "Scripts are cool.", Display.center )
 
     method update
       if (not script.update)
         script.add( CmdWaitFor(message) )
         script.add( CmdFlash(message,3) )
         script.add( CmdReset(message) )
       endIf
 
     method draw
       message.draw
 
     method on( MouseEvent e )
       if (e.is_button_press) message.reset
 endClass
 
 class Message( String text, Vector2 position )
   PROPERTIES
     count        &nbsp;: Int32
     visible=true &nbsp;: Logical
     script()     &nbsp;: Script

   METHODS
     method reset
       visible = true
       count = 0
       script.clear
 
     method revealed.Logical
       return (count == text.count)
 
     method update
       if (not script.update)
         if (count &lt; text.count)
           ++count
         else
           visible = not visible
         endIf
         script.add( CmdWait(0.20) )
       endIf
 
     method draw
       if (visible)
         SystemFont.handle = Handle.center
         SystemFont.draw( text.leftmost(count), position )
       endIf
 endClass
 
 class MessageCmd( Message message )&nbsp;: Cmd;
 
 class CmdWaitFor&nbsp;: MessageCmd
   method execute.Cmd
     message.update
     if (message.revealed) return next
     return this
 endClass
 
 class CmdFlash&nbsp;: Cmd
   PROPERTIES
     message&nbsp;: Message
     times  &nbsp;: Int32
 
   METHODS
     method init( message, times )
       times = times * 2  + 1
 
     method execute.Cmd
       message.visible = not message.visible
       --times
       if (times?)
         return CmdWait(0.2).chain(this)
       else
         return next
       endIf
 endClass
 
 class CmdReset&nbsp;: MessageCmd
   method on_activate
     message.reset
 endClass
</pre>
<a name="Credits" id="Credits"></a><h2> <span class="mw-headline"> Credits </span></h2>
<p>The Plasmacore Script system is based on Paul Stevens's (Riverman Media) Action Queue system.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 4/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key pw_mediawiki_user:pcache:idhash:137-0!1!0!!en!2!edit=0 and timestamp 20120628114245 -->
<div class="printfooter">
Retrieved from "<a href="">http://www.plasmaworks.com/wiki/index.php/Scripts</a>"</div>
						<!-- end content --><div class="visualClear"></div></div></div></div>
    <div id="column-one">
      <div id="p-cactions" class="portlet"></div>
      <div class="portlet" id="p-personal"></div>
      <div class="portlet" id="p-logo"></div>
      <div class="portlet" id="p-nav">
  
      </div>
      <div id="p-search" class="portlet"></div>
      <div class="portlet" id="p-tb"></div>
    </div>
    <!-- end left column -->
  <!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footerHacked">
				<ul id="f-list">
					<li id="lastmod"> This page was last modified on 31 January 2011, at 22:07.</li>
					<li id="viewcount">This page has been accessed 883 times.</li>
					<li id="privacy"><a href="plasmaworks_privacy_policy.html" title="Plasmaworks:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="plasmaworks_about.html" title="Plasmaworks:About">About Plasmaworks</a></li>
					<li id="disclaimer"><a href="plasmaworks_general_disclaimer.html" title="Plasmaworks:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.297 secs. --><br></body></html>
